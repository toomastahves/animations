(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     17536,        354]
NotebookOptionsPosition[     17234,        341]
NotebookOutlinePosition[     17581,        356]
CellTagsIndexPosition[     17538,        353]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"createMatrix", "[", "n_", "]"}], ":=", 
    RowBox[{"Table", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0"}], "}"}], ",", 
      RowBox[{"{", "n", "}"}], ",", 
      RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Turmite", "[", 
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "angle_", ",", "matrix_"}], "}"}], "]"}], 
    ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"color", ",", "state"}], "}"}], " ", "=", " ", 
        RowBox[{"matrix", "[", 
         RowBox[{"[", 
          RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newcolor", ",", "ruleangle", ",", "newstate"}], "}"}], "=", 
        RowBox[{"rules", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"state", "+", "1"}], ",", 
           RowBox[{"color", "+", "1"}]}], "]"}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"m", "=", " ", 
        RowBox[{"ReplacePart", "[", 
         RowBox[{"matrix", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], "\[Rule]", " ", 
           RowBox[{"{", 
            RowBox[{"newcolor", ",", "newstate"}], "}"}]}]}], "]"}]}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"x", "+", 
          RowBox[{"Cos", "[", 
           RowBox[{"angle", "+", "ruleangle"}], "]"}]}], ",", 
         RowBox[{"y", "+", 
          RowBox[{"Sin", "[", 
           RowBox[{"angle", "+", "ruleangle"}], "]"}]}], ",", 
         RowBox[{"angle", "+", "ruleangle"}], ",", "m"}], "}"}]}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"draw", "[", "result_", "]"}], ":=", " ", 
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0", ",", "y0", ",", "angle", ",", " ", "matrix"}], "}"}], 
       "=", "result"}], ";", "\[IndentingNewLine]", 
      RowBox[{"gGrid", " ", "=", " ", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"color", ",", "state"}], "}"}], " ", "=", " ", 
            RowBox[{"matrix", "[", 
             RowBox[{"[", 
              RowBox[{"x", ",", "y"}], "]"}], "]"}]}], ";", 
           "\[IndentingNewLine]", 
           RowBox[{"color", " ", "=", " ", 
            RowBox[{"Switch", "[", 
             RowBox[{
             "color", ",", "0", ",", "White", ",", "1", ",", "Black"}], 
             "]"}]}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"x", "\[Equal]", "x0"}], "&&", 
              RowBox[{"y", "\[Equal]", "y0"}]}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", "Red", ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x0", ",", "y0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x0", "+", "1"}], ",", 
                    RowBox[{"y0", "+", "1"}]}], "}"}]}], "]"}]}], "}"}], 
              "]"}], ",", "\[IndentingNewLine]", 
             RowBox[{"Graphics", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", "color", ",", 
                RowBox[{"Rectangle", "[", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{"x", ",", "y"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"x", "+", "1"}], ",", 
                    RowBox[{"y", "+", "1"}]}], "}"}]}], "]"}]}], "}"}], 
              "]"}]}], "]"}]}], "\[IndentingNewLine]", "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "1", ",", 
           RowBox[{"Length", "@", "matrix"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"y", ",", "1", ",", 
           RowBox[{"Length", "@", "matrix"}]}], "}"}]}], "]"}]}]}], 
     "\[IndentingNewLine]", "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"rules", " ", "=", " ", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", 
         RowBox[{
          RowBox[{"-", "Pi"}], "/", "2"}], ",", "1"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1"}], "}"}]}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", 
         RowBox[{"Pi", "/", "2"}], ",", "1"}], "}"}]}], "}"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"result", " ", "=", " ", 
    RowBox[{"NestList", "[", 
     RowBox[{"Turmite", ",", 
      RowBox[{"{", 
       RowBox[{"50", ",", "50", ",", 
        RowBox[{"Pi", "/", "2"}], ",", 
        RowBox[{"createMatrix", "[", "100", "]"}]}], "}"}], ",", "10000"}], 
     "]"}]}], ";"}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{"draw", "[", 
     RowBox[{"result", "[", 
      RowBox[{"[", 
       RowBox[{"Length", "@", "result"}], "]"}], "]"}], "]"}], "]"}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"frames", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"draw", "[", 
          RowBox[{"result", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "@", "result"}], ",", "20"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<40.Turmite.gif\>\"", ",", "frames", ",", " ", 
      RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "\[Infinity]"}], ",",
       " ", 
      RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}]}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.7398805893947525`*^9, 3.7398806052148733`*^9}, 
   3.739880679985114*^9, {3.7398807145684247`*^9, 3.7398807461410313`*^9}, {
   3.7398807899720397`*^9, 3.739880793068388*^9}, {3.7398808283187265`*^9, 
   3.7398810635080967`*^9}, {3.7398816104726315`*^9, 
   3.7398816343922577`*^9}, {3.739882922278825*^9, 3.739882983852448*^9}, {
   3.739883030057767*^9, 3.739883036967664*^9}, {3.739883101334504*^9, 
   3.7398831289045873`*^9}, {3.739883161131006*^9, 3.739883197640912*^9}, {
   3.7398832541408315`*^9, 3.739883361850912*^9}, {3.7398836605108957`*^9, 
   3.7398836877709208`*^9}, {3.739883722091055*^9, 3.7398837426838756`*^9}, {
   3.73988592756938*^9, 3.7398859298696785`*^9}, 3.7398910406419373`*^9, 
   3.7399648958833914`*^9, 3.73996638220195*^9, {3.7399777226907883`*^9, 
   3.7399777519606066`*^9}, {3.7399777852807465`*^9, 3.739977796690673*^9}, {
   3.7399778497106543`*^9, 3.7399779507098885`*^9}, {3.7399779815144877`*^9, 
   3.739978006910494*^9}, {3.7399814747372284`*^9, 3.7399814959449596`*^9}, 
   3.7399834703950996`*^9, {3.7399850630519667`*^9, 3.7399850752420197`*^9}, 
   3.739985586294726*^9, {3.7399858539647007`*^9, 3.7399858971347914`*^9}, {
   3.7399860477197456`*^9, 3.739986087043228*^9}, {3.739986136959654*^9, 
   3.739986227689228*^9}, {3.7399865065495014`*^9, 3.7399865312393312`*^9}, {
   3.7399870019649096`*^9, 3.7399870117651196`*^9}, {3.7399870572048464`*^9, 
   3.7399870677851267`*^9}, {3.7399871982446227`*^9, 
   3.7399872027745867`*^9}, {3.739987268042023*^9, 3.739987270072795*^9}, {
   3.7399873300282784`*^9, 3.739987406628175*^9}, 3.7399874460481253`*^9, {
   3.7399875553479643`*^9, 3.7399875945882416`*^9}, {3.739987694962341*^9, 
   3.739987711613089*^9}, {3.739988336346958*^9, 3.739988365308829*^9}, 
   3.739988467186681*^9, {3.7399885066868396`*^9, 3.7399885157665086`*^9}, {
   3.7399891911687*^9, 3.7399891944886837`*^9}, {3.739989348638376*^9, 
   3.7399893564183702`*^9}, {3.7399896238726015`*^9, 3.739989665274335*^9}, 
   3.7399897670762663`*^9, {3.7399912648966317`*^9, 3.739991519728032*^9}, {
   3.7399920104544396`*^9, 3.7399920292455983`*^9}, 3.7399924136952715`*^9, 
   3.7399924974565835`*^9, {3.7400246329673185`*^9, 3.7400246733172197`*^9}, {
   3.74002472114653*^9, 3.740024816891938*^9}, {3.7400249081316257`*^9, 
   3.740025306019253*^9}, {3.7400255177952666`*^9, 3.7400255683849096`*^9}, {
   3.740025627379985*^9, 3.7400256297596865`*^9}, {3.7400256784096503`*^9, 
   3.740025724489749*^9}, {3.74002582027966*^9, 3.740025826449586*^9}, {
   3.74002588566474*^9, 3.740026028365918*^9}, {3.7400260835347824`*^9, 
   3.7400262016777954`*^9}, {3.740026349277459*^9, 3.740026514315308*^9}, {
   3.7400265668391657`*^9, 3.7400265854751225`*^9}, 3.7400267058250628`*^9, {
   3.7400267516919093`*^9, 3.7400268471318064`*^9}, {3.7400269410357676`*^9, 
   3.740026972561533*^9}, {3.740028254279916*^9, 3.7400282595163317`*^9}, {
   3.740028292039514*^9, 3.740028294186308*^9}, {3.740028462716013*^9, 
   3.7400284931461577`*^9}, {3.740028673312292*^9, 3.740028674211996*^9}, {
   3.7400287133121147`*^9, 3.7400288388519*^9}, {3.7400289018501987`*^9, 
   3.7400289916960545`*^9}, {3.7400290989261837`*^9, 
   3.7400291197881804`*^9}, {3.7400292880641713`*^9, 3.740029291480096*^9}, {
   3.740029558126848*^9, 3.7400296653667817`*^9}, {3.7400297238413424`*^9, 
   3.740029929171212*^9}, {3.7400370285449405`*^9, 3.7400374182350874`*^9}, {
   3.7400374610548086`*^9, 3.7400376387944946`*^9}, {3.740037775053341*^9, 
   3.7400377859732757`*^9}, {3.740037875463026*^9, 3.740038277715431*^9}, {
   3.740038311675748*^9, 3.740038360185627*^9}, {3.740038594142202*^9, 
   3.740038621832184*^9}, {3.7400386539658422`*^9, 3.740038729977312*^9}, {
   3.740038791397441*^9, 3.7400388135972795`*^9}, 3.7400389792556376`*^9, 
   3.7400410505875316`*^9, 3.7400411792796183`*^9, {3.740041211280751*^9, 
   3.740041238001058*^9}, {3.740041274770889*^9, 3.74004133600109*^9}, {
   3.740041369970849*^9, 3.7400413714739704`*^9}, {3.7400414033107867`*^9, 
   3.740041432999546*^9}, {3.7400414740689306`*^9, 3.740041499879506*^9}, {
   3.740041533859789*^9, 3.740041594129739*^9}, {3.740041648011154*^9, 
   3.7400416708509564`*^9}, {3.740041742851956*^9, 3.7400418245524497`*^9}, {
   3.740042110404908*^9, 3.740042154736993*^9}, {3.740042195516985*^9, 
   3.7400421979173336`*^9}, {3.7400422356510286`*^9, 
   3.7400422418270283`*^9}, {3.7400423067672043`*^9, 
   3.7400423184172525`*^9}, {3.740043005371601*^9, 3.7400430445620813`*^9}, {
   3.740043079322069*^9, 3.740043270965289*^9}, {3.7400433252998323`*^9, 
   3.7400433464152007`*^9}, {3.7400434074496937`*^9, 
   3.7400434189694605`*^9}, {3.740044525007414*^9, 3.7400446084180317`*^9}, {
   3.7400446409077663`*^9, 3.740044806220756*^9}, {3.7400448367072077`*^9, 
   3.740044899506671*^9}, {3.740045015358226*^9, 3.740045069554264*^9}, {
   3.740046256279267*^9, 3.740046284051361*^9}, {3.740046594026835*^9, 
   3.74004660790076*^9}, {3.7400469134790783`*^9, 3.740046978829204*^9}, {
   3.7400470116990023`*^9, 3.740047118774947*^9}, {3.7400471634751024`*^9, 
   3.740047290325225*^9}, {3.740047351594922*^9, 3.740047354614911*^9}, {
   3.740047394855071*^9, 3.740047521915767*^9}, {3.7400477602864294`*^9, 
   3.7400477669341726`*^9}, {3.740048618268603*^9, 3.740048630588583*^9}, {
   3.7400486984109726`*^9, 3.740048770168817*^9}, {3.740048832148634*^9, 
   3.7400488328286858`*^9}, {3.7400489826261177`*^9, 
   3.7400491346859136`*^9}, {3.740049188205714*^9, 3.740049210655053*^9}, {
   3.740049353265082*^9, 3.7400495034944515`*^9}, {3.7400496352745543`*^9, 
   3.740049668228449*^9}, {3.7400497327272444`*^9, 3.7400497655564833`*^9}, {
   3.740049797617275*^9, 3.740049832477181*^9}, 3.740049888866953*^9, {
   3.74005015112298*^9, 3.7400501895464106`*^9}, {3.7400502232861547`*^9, 
   3.740050280486329*^9}, {3.7400528789574013`*^9, 3.7400529195975227`*^9}, {
   3.74005374812353*^9, 3.7400540123188677`*^9}, 3.7400540684998116`*^9, {
   3.7400541607556105`*^9, 3.7400541713653355`*^9}, {3.7400542108852625`*^9, 
   3.740054213515441*^9}, {3.740054277835021*^9, 3.740054306435209*^9}, {
   3.740054557175647*^9, 3.7400545618857927`*^9}, {3.7400547599281154`*^9, 
   3.74005479194843*^9}, {3.7400548493269005`*^9, 3.740054882077052*^9}, {
   3.7400582394445543`*^9, 3.7400583143911705`*^9}, {3.740058348601113*^9, 
   3.740058350490919*^9}, {3.7400583807711725`*^9, 3.740058496579581*^9}, {
   3.740058595829014*^9, 3.7400587156633887`*^9}, {3.7400587513732634`*^9, 
   3.7400587516946917`*^9}, {3.740058857533001*^9, 3.7400589555010834`*^9}, {
   3.7400589877812815`*^9, 3.740058990173658*^9}, {3.7400590884511175`*^9, 
   3.740059240847541*^9}, {3.7400592949775033`*^9, 3.74005930885927*^9}, {
   3.7400594226974754`*^9, 3.7400594709275236`*^9}, {3.740059548337081*^9, 
   3.7400595823371162`*^9}, 3.74006001747149*^9, {3.7400602632381167`*^9, 
   3.7400602654784017`*^9}, {3.7400603128781624`*^9, 3.740060617342491*^9}, {
   3.740060662694874*^9, 3.7400606976450324`*^9}, {3.7400607465245852`*^9, 
   3.740060867154464*^9}, {3.7400609680767183`*^9, 3.7400610149264574`*^9}, {
   3.7400611633161726`*^9, 3.7400611786605387`*^9}, {3.7400616942360554`*^9, 
   3.7400618002562385`*^9}, {3.740061933564976*^9, 3.7400619726358395`*^9}, {
   3.7400620332889585`*^9, 3.7400621434863906`*^9}, {3.7400621886460743`*^9, 
   3.7400623166961565`*^9}, {3.740062350769989*^9, 3.740062400008578*^9}, {
   3.740062505678235*^9, 3.740062598248343*^9}, {3.7400626695259075`*^9, 
   3.7400626886556764`*^9}, {3.7400628102456074`*^9, 3.740062819765469*^9}, {
   3.7400628741400127`*^9, 3.740062904599879*^9}, {3.740063252731632*^9, 
   3.7400633071279364`*^9}, {3.7400634059042954`*^9, 
   3.7400634419644475`*^9}, {3.7400638919823923`*^9, 3.74006394909868*^9}, {
   3.7400639840391035`*^9, 3.740063990509396*^9}, {3.740064402841948*^9, 
   3.740064435242069*^9}, {3.740064472271727*^9, 3.7400645132717485`*^9}, {
   3.740064590381839*^9, 3.7400646391577454`*^9}, {3.7400672721983824`*^9, 
   3.7400672875879984`*^9}, {3.740067324248357*^9, 3.740067335898405*^9}, {
   3.740067367268354*^9, 3.7400674015483613`*^9}, 3.7400674656282716`*^9, {
   3.7400675214695725`*^9, 3.740067723959659*^9}, {3.7400677547595663`*^9, 
   3.740067784329517*^9}, {3.740068816602103*^9, 3.7400688528021445`*^9}, {
   3.7400688839623966`*^9, 3.740068900442569*^9}, {3.7400689544523873`*^9, 
   3.740069000819814*^9}, {3.740069043649866*^9, 3.740069060839478*^9}, {
   3.7400702026976223`*^9, 3.740070231617296*^9}, {3.740070403137417*^9, 
   3.7400704523073573`*^9}, {3.7400704979254723`*^9, 3.740070511975194*^9}, {
   3.7400706332953215`*^9, 3.7400706393551207`*^9}, {3.740070778300156*^9, 
   3.7400708958631535`*^9}, {3.7400709505428157`*^9, 
   3.7400709518673687`*^9}, {3.7400709969031177`*^9, 3.740071036873151*^9}, {
   3.740071215283306*^9, 3.7400712171133204`*^9}, {3.7400713025844793`*^9, 
   3.740071314004613*^9}, {3.7400714272142715`*^9, 3.7400714408745656`*^9}, {
   3.7400714903344107`*^9, 3.740071498454467*^9}, {3.7400715508442698`*^9, 
   3.740071705965964*^9}, {3.7400739209530773`*^9, 3.740073926424131*^9}, {
   3.740241157398093*^9, 3.740241274967985*^9}, {3.740241576526202*^9, 
   3.740241592165838*^9}, {3.7402416251760006`*^9, 3.7402423271944284`*^9}, {
   3.7402423583442016`*^9, 3.740242436568263*^9}, {3.7402424853441143`*^9, 
   3.740242582838626*^9}, {3.7402426999056983`*^9, 3.7402427961257405`*^9}, {
   3.740242954319705*^9, 3.740243089740632*^9}, {3.7402432020035133`*^9, 
   3.740243250479523*^9}, {3.740243293499488*^9, 3.7402433166697407`*^9}, {
   3.7402434032806015`*^9, 3.7402435124004264`*^9}, {3.740245969122991*^9, 
   3.740245996537833*^9}, {3.7402471929158773`*^9, 
   3.7402472295363255`*^9}},ExpressionUUID->"ab2a2698-0dd0-4967-abbf-\
2f9d54d2d12c"]
},
WindowSize->{974, 996},
WindowMargins->{{Automatic, 43}, {71, Automatic}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 16672, 319, 637, "Input",ExpressionUUID->"ab2a2698-0dd0-4967-abbf-2f9d54d2d12c"]
}
]
*)

