(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[      8524,        202]
NotebookOptionsPosition[      8222,        189]
NotebookOutlinePosition[      8570,        204]
CellTagsIndexPosition[      8527,        201]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"BarnsleyFern", "[", 
    RowBox[{"{", 
     RowBox[{"x_", ",", "y_"}], "}"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"i", " ", "=", " ", 
       RowBox[{"RandomInteger", "[", 
        RowBox[{"{", 
         RowBox[{"1", ",", "100"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"i", "\[LessEqual]", "1"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"xt", "=", "0"}], ",", 
          RowBox[{"yt", "=", 
           RowBox[{"0.16", "*", "y"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"i", "\[LessEqual]", "8"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"xt", "=", 
             RowBox[{
              RowBox[{"0.2", "*", "x"}], "-", 
              RowBox[{"0.26", "*", "y"}]}]}], ",", 
            RowBox[{"yt", "=", 
             RowBox[{
              RowBox[{"0.23", "*", "x"}], "+", 
              RowBox[{"0.22", "*", "y"}], "+", "1.6"}]}]}], "}"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"i", "\[LessEqual]", "15"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xt", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.15"}], "*", "x"}], "+", 
                RowBox[{"0.28", "*", "y"}]}]}], ",", 
              RowBox[{"yt", "=", 
               RowBox[{
                RowBox[{"0.26", "*", "x"}], "+", 
                RowBox[{"0.24", "*", "y"}], "+", "0.44"}]}]}], "}"}], ",", 
            "\[IndentingNewLine]", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"xt", "=", 
               RowBox[{
                RowBox[{"0.85", "*", "x"}], "+", 
                RowBox[{"0.04", "*", "y"}]}]}], ",", 
              RowBox[{"yt", "=", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "0.04"}], "*", "x"}], "+", 
                RowBox[{"0.85", "*", "y"}], "+", "1.6"}]}]}], "}"}]}], 
           "]"}]}], "]"}]}], "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"xt", ",", "yt"}], "}"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"points", " ", "=", " ", 
   RowBox[{"NestList", "[", 
    RowBox[{"BarnsleyFern", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0"}], "}"}], ",", "10000"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gPoints", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Hue", "[", 
        RowBox[{".35", ",", "1", ",", ".7"}], "]"}], ",", 
       RowBox[{"PointSize", "[", ".001", "]"}], ",", 
       RowBox[{"Point", "[", "#", "]"}]}], "}"}], "&"}], "/@", "points"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"partitioned", " ", "=", " ", 
   RowBox[{"Partition", "[", 
    RowBox[{"gPoints", ",", "10000"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"folded", " ", "=", " ", 
   RowBox[{"FoldList", "[", 
    RowBox[{"List", ",", "partitioned"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"frames", " ", "=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Show", "[", 
      RowBox[{
       RowBox[{"Graphics", "[", "#", "]"}], ",", 
       RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], "&"}], "/@", 
    "folded"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ListAnimate", "@", "frames"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<46.1.BarnsleyFern.gif\>\"", ",", "frames", ",", " ", 
      RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "\[Infinity]"}], ",",
       " ", 
      RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".1"}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.740663344967634*^9, 3.7406633975574913`*^9}, {
   3.740663601690876*^9, 3.7406638233475356`*^9}, {3.740663858396555*^9, 
   3.7406639017964964`*^9}, {3.740663982651916*^9, 3.7406640219214296`*^9}, {
   3.7406640605318213`*^9, 3.740664184425938*^9}, {3.7406642335556064`*^9, 
   3.740664258050499*^9}, {3.7406644656450357`*^9, 3.7406645471715612`*^9}, {
   3.7406646303566427`*^9, 3.7406646385816793`*^9}, {3.7406646734813566`*^9, 
   3.740664816931411*^9}, {3.740664849892908*^9, 3.740664933373056*^9}, {
   3.740664977078943*^9, 3.7406651081380463`*^9}, {3.740665258308099*^9, 
   3.7406652755730066`*^9}, {3.7406653451504736`*^9, 
   3.7406653482354984`*^9}, {3.740665411215942*^9, 3.7406656855971365`*^9}, {
   3.740665846516738*^9, 3.7406660141380606`*^9}, 3.7406676394813423`*^9, {
   3.7406676720120687`*^9, 3.740667697335987*^9}, {3.7406677530176067`*^9, 
   3.740667754963297*^9}, {3.740667786462556*^9, 3.740668026792941*^9}, {
   3.740668078007656*^9, 3.740668249327936*^9}, {3.740668307841951*^9, 
   3.7406683174719076`*^9}, {3.7406683606573124`*^9, 
   3.7406683835122657`*^9}, {3.7406684358476467`*^9, 
   3.7406687285223427`*^9}, {3.7406688021417513`*^9, 
   3.7406688197805824`*^9}, {3.7406688593220787`*^9, 
   3.7406689136371527`*^9}, {3.7406689834115267`*^9, 3.740669015216796*^9}, {
   3.7406691150177655`*^9, 3.740669116153558*^9}, {3.7406691768089046`*^9, 
   3.7406692695035663`*^9}, {3.7406693809637213`*^9, 
   3.7406694529533844`*^9}, {3.740669623507972*^9, 3.7406697565935946`*^9}, {
   3.7406698792536063`*^9, 3.740669918023546*^9}, {3.7406700377383175`*^9, 
   3.7406701093333273`*^9}, {3.740670148508041*^9, 3.7406701504833755`*^9}, {
   3.740670231273227*^9, 3.7406702964588614`*^9}, {3.740670415615632*^9, 
   3.740670493211118*^9}, {3.7406707757203064`*^9, 3.7406707967706704`*^9}, {
   3.7406708479054694`*^9, 3.7406708713955455`*^9}, {3.740671160236054*^9, 
   3.7406711777451296`*^9}, {3.74067133079922*^9, 3.740671359910505*^9}, {
   3.7406714779152155`*^9, 3.740671489641594*^9}, {3.740671522145442*^9, 
   3.740671522794365*^9}, {3.7406718415644293`*^9, 3.740671927025524*^9}, {
   3.740672021474065*^9, 3.7406720631933427`*^9}, {3.740672137403512*^9, 
   3.740672230729971*^9}, {3.740672275634157*^9, 3.740672283299483*^9}, {
   3.7406724206146526`*^9, 3.740672573464925*^9}, {3.7406727675673666`*^9, 
   3.7406728353827333`*^9}, {3.7406729428474865`*^9, 
   3.7406730576710186`*^9}, {3.740673092567793*^9, 3.740673227932519*^9}, {
   3.7406732918725243`*^9, 3.7406733519367933`*^9}, 3.7406733833275223`*^9, {
   3.74067343164028*^9, 3.7406734552391376`*^9}, {3.7406737400172167`*^9, 
   3.740673749197328*^9}, {3.7406737911133833`*^9, 3.7406738150024147`*^9}, {
   3.7406738735784087`*^9, 3.7406739777783036`*^9}, {3.7406740146732483`*^9, 
   3.7406740520508623`*^9}, {3.740674118138178*^9, 3.7406741203188953`*^9}, {
   3.74067415836823*^9, 3.7406742582877784`*^9}, {3.7406743065380917`*^9, 
   3.740674319800318*^9}, {3.740674402278017*^9, 3.7406744367333956`*^9}, 
   3.7406745217058725`*^9, {3.740675440784915*^9, 3.7406757450222764`*^9}, {
   3.740675938760887*^9, 3.7406761926728406`*^9}, {3.740676241693084*^9, 
   3.740676259162943*^9}, {3.7406762958134665`*^9, 3.7406762994632998`*^9}, {
   3.74067719589843*^9, 3.740677198669137*^9}, {3.7406807488313103`*^9, 
   3.7406807678828707`*^9}, {3.7406808243464746`*^9, 
   3.7406808459228444`*^9}},ExpressionUUID->"8e3f9c3d-ece1-45c3-83db-\
232a21fe2bc3"]
},
WindowSize->{1108, 767},
WindowMargins->{{Automatic, 50}, {69, Automatic}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 7660, 167, 352, "Input",ExpressionUUID->"8e3f9c3d-ece1-45c3-83db-232a21fe2bc3"]
}
]
*)

