(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 11.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16574,        355]
NotebookOptionsPosition[     16269,        342]
NotebookOutlinePosition[     16619,        357]
CellTagsIndexPosition[     16576,        354]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"createMatrix", "[", "n_", "]"}], ":=", 
   RowBox[{"Table", "[", 
    RowBox[{"0", ",", 
     RowBox[{"{", "n", "}"}], ",", 
     RowBox[{"{", "n", "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"toggleValue", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "direction_"}], "}"}], ",", "matrix_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"ReplacePart", "[", 
      RowBox[{"matrix", ",", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"#1", ",", "#2"}], "}"}], "->", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"matrix", "[", 
             RowBox[{"[", "#1", "]"}], "]"}], "[", 
            RowBox[{"[", "#2", "]"}], "]"}], "\[Equal]", "0"}], ",", "1", ",",
           "0"}], "]"}]}]}], "]"}], "&"}], "[", 
    RowBox[{"x", ",", "y"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"makeMove", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"x_", ",", "y_", ",", "direction_"}], "}"}], ",", "matrix_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"Switch", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"matrix", "[", 
         RowBox[{"[", "#1", "]"}], "]"}], "[", 
        RowBox[{"[", "#2", "]"}], "]"}], ",", "0", ",", 
       RowBox[{"turnRight", "[", 
        RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}], ",", "1", ",", 
       RowBox[{"turnLeft", "[", 
        RowBox[{"#1", ",", "#2", ",", "#3"}], "]"}]}], "]"}], "&"}], "[", 
    RowBox[{"x", ",", "y", ",", "direction"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"turnRight", "[", 
    RowBox[{"x_", ",", "y_", ",", "direction_"}], "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"direction", ",", "\[IndentingNewLine]", "\"\<N\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "+", "1"}], ",", "y", ",", " ", "\"\<E\>\""}], "}"}], ",",
      "\[IndentingNewLine]", "\"\<E\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"y", "-", "1"}], ",", "\"\<S\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", "\"\<S\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "-", "1"}], ",", "y", ",", "\"\<W\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", "\"\<W\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"y", "+", "1"}], ",", "\"\<N\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"turnLeft", "[", 
    RowBox[{"x_", ",", "y_", ",", "direction_"}], "]"}], ":=", 
   RowBox[{"Switch", "[", 
    RowBox[{"direction", ",", "\[IndentingNewLine]", "\"\<N\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "-", "1"}], ",", "y", ",", " ", "\"\<W\>\""}], "}"}], ",",
      "\[IndentingNewLine]", "\"\<W\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"y", "-", "1"}], ",", "\"\<S\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", "\"\<S\>\"", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"x", "+", "1"}], ",", "y", ",", "\"\<E\>\""}], "}"}], ",", 
     "\[IndentingNewLine]", "\"\<E\>\"", ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"y", "+", "1"}], ",", "\"\<N\>\""}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"visualizeMatrix", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"x0_", ",", "y0_", ",", "direction_"}], "}"}], ",", 
       "matrix_"}], "}"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Graphics", "[", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"EdgeForm", "[", "Thin", "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "y"}], "}"}], "\[Equal]", 
            RowBox[{"{", 
             RowBox[{"x0", ",", "y0"}], "}"}]}], ",", "Red", ",", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"matrix", "[", 
                RowBox[{"[", "x", "]"}], "]"}], "[", 
               RowBox[{"[", "y", "]"}], "]"}], "\[Equal]", "1"}], ",", 
             "Black", ",", "White"}], "]"}]}], "]"}], ",", " ", 
         "\[IndentingNewLine]", 
         RowBox[{"Rectangle", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "y"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"x", "+", "1"}], ",", 
             RowBox[{"y", "+", "1"}]}], "}"}]}], "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "1", ",", 
         RowBox[{"Length", "@", "matrix"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "1", ",", 
         RowBox[{"Length", "@", "matrix"}]}], "}"}]}], "]"}], "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"LangtonsAnt", "[", 
     RowBox[{"{", 
      RowBox[{"ant_", ",", " ", "matrix_"}], "}"}], "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"makeMove", "[", 
       RowBox[{"ant", ",", "matrix"}], "]"}], ",", 
      RowBox[{"toggleValue", "[", 
       RowBox[{"ant", ",", "matrix"}], "]"}]}], "}"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"init", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"5", ",", "5", ",", "\"\<N\>\""}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matrix", " ", "=", " ", 
   RowBox[{"createMatrix", "[", "10", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"steps", " ", "=", " ", "115"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"result", " ", "=", " ", 
   RowBox[{"Nest", "[", 
    RowBox[{"LangtonsAnt", ",", 
     RowBox[{"{", 
      RowBox[{"init", ",", "matrix"}], "}"}], ",", " ", "steps"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"visualizeMatrix", "[", "result", "]"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"result2", "=", " ", 
     RowBox[{"NestList", "[", 
      RowBox[{"LangtonsAnt", ",", 
       RowBox[{"{", 
        RowBox[{"init", ",", "matrix"}], "}"}], ",", " ", "steps"}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"gFrames", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Show", "[", 
        RowBox[{
         RowBox[{"visualizeMatrix", "[", 
          RowBox[{"result2", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", 
         RowBox[{"ImageSize", "\[Rule]", "Large"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "11500", ",", "10"}], "}"}]}], "]"}]}], 
    ";", "\[IndentingNewLine]", 
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"Export", "[", 
     RowBox[{"\"\<27.LangtonsAnt.gif\>\"", ",", "gFrames", ",", " ", 
      RowBox[{"\"\<AnimationRepetitions\>\"", "\[Rule]", "\[Infinity]"}], ",",
       " ", 
      RowBox[{"\"\<DisplayDurations\>\"", "\[Rule]", ".05"}]}], "]"}]}], 
   "\[IndentingNewLine]", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.7388469480081797`*^9, 3.7388469499241495`*^9}, {
   3.7388490978170023`*^9, 3.738849191401248*^9}, {3.738849290499112*^9, 
   3.7388496046257343`*^9}, {3.7388496682805805`*^9, 
   3.7388496974399924`*^9}, {3.738849737617485*^9, 3.7388497738491716`*^9}, {
   3.7388504868504105`*^9, 3.738850670094429*^9}, {3.738850833847378*^9, 
   3.7388508549773817`*^9}, {3.738850902104965*^9, 3.738851064078949*^9}, {
   3.738851207632382*^9, 3.738851319487616*^9}, {3.7388513770930076`*^9, 
   3.7388514866865425`*^9}, {3.738851518992423*^9, 3.738851543694726*^9}, 
   3.738851688649724*^9, {3.7388517191590996`*^9, 3.7388517357843957`*^9}, {
   3.7388518175585256`*^9, 3.738851822317511*^9}, {3.7388518981748667`*^9, 
   3.738852025022373*^9}, {3.738852057093137*^9, 3.738852343884404*^9}, {
   3.7388523871805215`*^9, 3.738852766133441*^9}, {3.738852801683653*^9, 
   3.7388528041803274`*^9}, {3.7388529223990316`*^9, 3.738853120421295*^9}, {
   3.738853199802288*^9, 3.738853412418731*^9}, {3.73885345425415*^9, 
   3.738853509218942*^9}, {3.738853574541113*^9, 3.738853579239378*^9}, {
   3.738853632415086*^9, 3.7388538748913107`*^9}, {3.7388539694667425`*^9, 
   3.738853973475241*^9}, {3.738854056011407*^9, 3.738854092676258*^9}, {
   3.7388542184670486`*^9, 3.7388542731939497`*^9}, {3.7388543418429947`*^9, 
   3.7388543820273495`*^9}, {3.738854443729932*^9, 3.7388544848551054`*^9}, {
   3.738854569424981*^9, 3.738854848603548*^9}, {3.7388557200660906`*^9, 
   3.7388558702319984`*^9}, {3.7388559197158346`*^9, 
   3.7388559322317047`*^9}, {3.7388560179598656`*^9, 3.738856065159375*^9}, {
   3.7388560960240602`*^9, 3.738856118351367*^9}, {3.7388586251721067`*^9, 
   3.738858697813963*^9}, {3.7388587836441536`*^9, 3.7388588316046047`*^9}, {
   3.738858963816699*^9, 3.7388590100512133`*^9}, {3.7388596645638905`*^9, 
   3.7388597465479774`*^9}, {3.73885978893404*^9, 3.738859862602747*^9}, {
   3.7388599333706207`*^9, 3.7388600543317957`*^9}, {3.738860098393135*^9, 
   3.738860178789076*^9}, {3.7388607102164106`*^9, 3.738860873883813*^9}, {
   3.738861192237809*^9, 3.738861367586025*^9}, {3.7388614300401506`*^9, 
   3.7388614750157537`*^9}, {3.7388615514822397`*^9, 3.7388616008725147`*^9}, 
   3.738862064666588*^9, {3.738862163880212*^9, 3.7388621766792116`*^9}, 
   3.738862340389075*^9, {3.7388631270578775`*^9, 3.738863145514439*^9}, {
   3.738863931519245*^9, 3.73886393281331*^9}, {3.738864110868404*^9, 
   3.7388642232039623`*^9}, {3.738864469533016*^9, 3.7388646854437513`*^9}, {
   3.7388655711705847`*^9, 3.7388656007395554`*^9}, {3.7388656498109083`*^9, 
   3.738865695523474*^9}, {3.7388657376550107`*^9, 3.738865758218578*^9}, {
   3.7388657997951956`*^9, 3.73886580976646*^9}, {3.7388658525541677`*^9, 
   3.7388658720976553`*^9}, {3.7388659428424306`*^9, 
   3.7388659587775574`*^9}, {3.738866007644039*^9, 3.7388660091632853`*^9}, {
   3.738866146633155*^9, 3.7388662202424283`*^9}, {3.738866257485177*^9, 
   3.7388662630100284`*^9}, {3.7388662956854286`*^9, 3.738866416505406*^9}, {
   3.738866458708216*^9, 3.7388665661309576`*^9}, 3.7388679500867743`*^9, {
   3.738868001898312*^9, 3.738868097038997*^9}, {3.7388681316798344`*^9, 
   3.7388681343116083`*^9}, {3.738868222543935*^9, 3.738868258755383*^9}, 
   3.738877117983573*^9, {3.738895904633274*^9, 3.7388961247757998`*^9}, {
   3.738896595053951*^9, 3.73889671657787*^9}, {3.7388967826712008`*^9, 
   3.738896794590578*^9}, {3.738896847139924*^9, 3.7388969440632877`*^9}, {
   3.738896995765479*^9, 3.7388971541337395`*^9}, {3.7388972471007833`*^9, 
   3.738897403126336*^9}, {3.738897548192168*^9, 3.7388975957441273`*^9}, {
   3.7388976835266085`*^9, 3.738897755597945*^9}, {3.738897881061417*^9, 
   3.7388978888517723`*^9}, {3.7388979223082113`*^9, 3.7388979457719665`*^9}, 
   3.7388980272119246`*^9, {3.7388984083916435`*^9, 3.7388984341569996`*^9}, {
   3.738898593134844*^9, 3.738898732844453*^9}, 3.738898794304982*^9, {
   3.738898921905857*^9, 3.7388989608841662`*^9}, {3.7388989926373987`*^9, 
   3.7388992033708553`*^9}, {3.738899249603447*^9, 3.738899255877426*^9}, {
   3.738899335565232*^9, 3.738899403178047*^9}, {3.738899452772334*^9, 
   3.738899469762355*^9}, {3.7388996542129073`*^9, 3.738899659810112*^9}, {
   3.7388996987217865`*^9, 3.7388997381382275`*^9}, {3.7388998352617855`*^9, 
   3.7388998386673136`*^9}, {3.738899905107909*^9, 3.738899905562698*^9}, {
   3.738900211768545*^9, 3.738900431313051*^9}, {3.7389004901932898`*^9, 
   3.738900612917762*^9}, {3.7389007901814003`*^9, 3.738900870887969*^9}, {
   3.7389009030088234`*^9, 3.7389010398174353`*^9}, {3.738901170791373*^9, 
   3.738901186217022*^9}, {3.7389012302805586`*^9, 3.7389012409051523`*^9}, {
   3.7389012927361283`*^9, 3.738901316479998*^9}, {3.738901571326233*^9, 
   3.7389017253607984`*^9}, {3.7389017670236607`*^9, 3.7389020073119*^9}, {
   3.73890228269578*^9, 3.7389022885975914`*^9}, 3.7389023350949154`*^9, {
   3.738902396910096*^9, 3.7389024583101397`*^9}, 3.7389026094544225`*^9, {
   3.738902867711918*^9, 3.7389029178130646`*^9}, {3.7389030546475334`*^9, 
   3.7389030644851246`*^9}, {3.7389031689336157`*^9, 3.738903197165595*^9}, {
   3.7389032524209957`*^9, 3.7389032563167267`*^9}, {3.7389040011792903`*^9, 
   3.738904005675939*^9}, {3.7389052102924333`*^9, 3.738905341036569*^9}, {
   3.7389054042412434`*^9, 3.7389055658252087`*^9}, {3.7389057016294303`*^9, 
   3.738905824122376*^9}, {3.738906031321517*^9, 3.7389061108724403`*^9}, {
   3.738906169641178*^9, 3.738906577800208*^9}, {3.738906610617133*^9, 
   3.738906827593067*^9}, {3.7389068597056556`*^9, 3.7389069390399733`*^9}, {
   3.7389069750081472`*^9, 3.7389070283308783`*^9}, {3.738907097648096*^9, 
   3.738907101407815*^9}, {3.738907167856099*^9, 3.7389072271039753`*^9}, {
   3.7389073610555105`*^9, 3.738907385729927*^9}, {3.7389074987985525`*^9, 
   3.7389075802413783`*^9}, {3.7389077636939573`*^9, 
   3.7389078209761167`*^9}, {3.738907866432513*^9, 3.738907969542491*^9}, {
   3.738908197297881*^9, 3.7389082074402514`*^9}, {3.7389089968848486`*^9, 
   3.7389089976131725`*^9}, {3.738909071529516*^9, 3.7389093671804075`*^9}, {
   3.7389094075841827`*^9, 3.7389094596930037`*^9}, {3.738909744455599*^9, 
   3.738909762088224*^9}, {3.738909828947892*^9, 3.7389098491829867`*^9}, {
   3.738912498516123*^9, 3.738912585698411*^9}, {3.7389126179433346`*^9, 
   3.7389126185427313`*^9}, {3.738916762399844*^9, 3.7389167734106593`*^9}, {
   3.738916843169827*^9, 3.738916879315098*^9}, {3.7389169565785623`*^9, 
   3.7389172457571063`*^9}, 3.738917300130149*^9, {3.7389258936216764`*^9, 
   3.7389258977649145`*^9}, {3.7389310715891466`*^9, 3.738931080968816*^9}, {
   3.738937772228854*^9, 3.7389379971805325`*^9}, {3.7389380339970055`*^9, 
   3.73893806031658*^9}, {3.7389381250528893`*^9, 3.738938214823495*^9}, {
   3.738938299954835*^9, 3.7389383641801558`*^9}, {3.73893842392694*^9, 
   3.7389384578127146`*^9}, {3.7389389265228395`*^9, 3.738938993746585*^9}, 
   3.7389395755257263`*^9, {3.7389551483411055`*^9, 3.7389551923649335`*^9}, {
   3.7389552239054823`*^9, 3.738955345739606*^9}, {3.738955379399708*^9, 
   3.7389554935149016`*^9}, {3.738955528986988*^9, 3.738955535062028*^9}, {
   3.7389555899894485`*^9, 3.738955614990652*^9}, {3.7389556544313774`*^9, 
   3.738955694570963*^9}, {3.73895573307635*^9, 3.738955849730522*^9}, 
   3.7389560409152727`*^9, {3.738984939903656*^9, 3.73898496055134*^9}, {
   3.7389853932526317`*^9, 3.738985431924203*^9}, {3.738985478223754*^9, 
   3.7389854877313995`*^9}, {3.738985898318805*^9, 3.738985900384816*^9}, {
   3.7389861173206105`*^9, 3.738986167958124*^9}, {3.738987430685791*^9, 
   3.738987442546425*^9}, {3.738987543124463*^9, 3.738987619821949*^9}, {
   3.738987833780242*^9, 3.7389879671892977`*^9}, {3.7389897990552506`*^9, 
   3.7389898278846855`*^9}, {3.7390110541860733`*^9, 3.739011184184397*^9}, {
   3.7390112819335003`*^9, 3.7390113676352816`*^9}, {3.739011402094178*^9, 
   3.739011501978322*^9}, 3.7390115523978014`*^9, {3.739019695065779*^9, 
   3.7390197449557123`*^9}, {3.7390266001085396`*^9, 3.739026651174878*^9}, {
   3.739026709803276*^9, 3.739026711117566*^9}, {3.7390267862015433`*^9, 
   3.7390268498759823`*^9}, 3.73902870577954*^9, {3.7390738534845533`*^9, 
   3.739073873324395*^9}, {3.7390739643646064`*^9, 
   3.7390739731645594`*^9}},ExpressionUUID->"20b4a068-b0e6-4ed5-a3d8-\
9ddbe5e527db"]
},
WindowSize->{1281, 872},
WindowMargins->{{Automatic, 331}, {117, Automatic}},
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 15707, 320, 618, "Input",ExpressionUUID->"20b4a068-b0e6-4ed5-a3d8-9ddbe5e527db"]
}
]
*)

